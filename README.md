# 自动阅卷系统使用说明 

最接近原版，单题，三种AI模式，有给分、不给分输入（后续可简化，全部归入评分细则栏中）
使用时建议删除api_service.py中的api连接测试相关内容。此功能用于开发，使用稍显累赘。
代码冗余屎山，大神可尽情修改，多多指教。
软件中有过多日志要求，目的是方便开发。用户也可理解，但意义不大。
后续开发版本：豆包多题版本；作文三部分打分版本；
开心，本人零基础起步，一个月时间，站在巨人的肩膀上复现出此软件，感谢世界。科技真的能够改变人类吗？历史的答案似乎是：曲折的。爸爸告诉我，自由和安全是人永恒的追求。


## 软件简介

本软件是一个基于AI的自动阅卷系统，可以通过截取学生答题区域的图片，利用AI模型进行自动评分。系统支持多种AI模型，可以根据预设的评分标准对学生答案进行智能评分，并自动将分数输入到指定位置。

## 功能特点

1. **多模型支持**：支持豆包视觉模型、智谱GLM-4V等多种AI模型
2. **自定义评分标准**：可设置评分细则、给分点和不给分点
3. **批量处理**：支持连续处理多份答卷，自动翻页
4. **自动输入**：评分后自动在指定位置输入分数
5. **记录保存**：自动保存评分记录和AI分析结果
6. **界面友好**：直观的图形界面，操作简单

## 系统要求

- 操作系统：Windows 10/11
- Python 3.7+
- PyQt5
- 网络连接（用于调用AI API）
- 相关API密钥（豆包视觉、智谱等）

## 安装步骤

1. 克隆或下载代码库到本地
2. 安装依赖库：
   ```bash
   pip install PyQt5 requests configparser pyautogui pillow

   3. 运行主程序：
   ```bash
   python main.py
    ```
## 使用流程
### 1. 初始配置
1. API设置 ：
   
   - 在主界面输入各AI模型的API密钥
   - 火山方舟API密钥
   - 豆包视觉模型ID
   - 智谱API密钥
2. 位置设置 ：
   
   - 点击"设置分数输入位置"按钮，然后点击目标系统的分数输入框
   - 点击"设置提交按钮位置"按钮，然后点击目标系统的提交按钮
   - 如需自动翻页，点击"设置翻页按钮位置"按钮，然后点击目标系统的翻页按钮
3. 答案区域设置 ：
   
   - 点击"框定答案区域"按钮
   - 调整红色框的位置和大小，使其完全覆盖学生答案区域
   - 点击"确认框定"按钮锁定答案区域
### 2. 评分设置
1. 评分标准设置 ：
   
   - 选择科目
   - 输入标准答案和评分细则
   - 设置给分点和不给分点示例
   - 设置最高分值
   - 选择评分标准（严格/宽松）
2. 批量处理设置 ：
   
   - 设置循环次数（处理答卷数量）
   - 设置等待时间（每次评分之间的间隔）
   - 设置分数范围（最低分和最高分）
### 3. 开始评分
1. 点击"开始自动阅卷"按钮
2. 系统会自动：
   - 截取当前答案区域图片
   - 调用AI模型分析答案
   - 提取评分和评分依据
   - 在指定位置输入分数
   - 点击提交按钮
   - 如已设置，点击翻页按钮进入下一份答卷
### 4. 查看结果
- 评分过程和结果会实时显示在主界面
- 评分记录会自动保存在"阅卷记录"文件夹中
## 文件结构说明
- main.py ：主程序入口
- api_service.py ：API服务类，负责调用各种AI API
- auto_thread.py ：自动阅卷线程，处理评分逻辑
- config_manager.py ：配置管理器，处理配置文件
- ui_components/ ：UI组件目录
  - main_window.py ：主窗口界面
  - answer_window.py ：答案框窗口类
- setting/ ：配置文件目录
  - config.ini ：保存API密钥和位置设置
  - answer.png ：保存答案区域截图
## 开发指南
### 核心类说明
1. Application ：应用程序主类，负责初始化和协调各组件
2. ApiService ：API服务类，封装了各种AI API的调用方法
3. AutoThread ：自动阅卷线程，实现评分和自动操作逻辑
4. MainWindow ：主窗口类，实现用户界面和交互
5. MyWindow2 ：答案框窗口类，用于框定答案区域
### 扩展开发
1. 添加新的AI模型 ：
   
   - 在 api_service.py 中添加新的API调用方法
   - 在主界面添加相应的API设置选项
   - 在 auto_thread.py 的 process_with_model 方法中添加新模型的处理逻辑
2. 优化评分算法 ：
   
   - 修改 extract_score_info 方法以改进分数提取逻辑
   - 调整提示词生成逻辑以获得更准确的AI评分
3. 增强用户界面 ：
   
   - 在 main_window.py 中添加新的UI元素和功能
   - 优化交互流程和视觉反馈
## 常见问题
1. 无法连接API ：
   
   - 检查API密钥是否正确
   - 确认网络连接是否正常
   - 查看日志信息了解详细错误
2. 评分不准确 ：
   
   - 调整评分标准和给分点设置
   - 优化提示词，使AI更好理解评分要求
   - 考虑使用不同的AI模型
3. 自动操作失败 ：
   
   - 重新设置分数输入、提交和翻页按钮位置
   - 确保目标系统界面没有变化
   - 适当增加操作间的等待时间
## 分数处理说明
系统对分数的处理规则如下：

- 如果分数是0.5的倍数（如1.5、2.0、2.5等），将保持原样输入
- 如果分数不是0.5的倍数（如1.2、2.7等），将四舍五入为整数后输入
- 系统会确保分数在设定的最低分和最高分范围内
## 联系与支持
如有问题或建议，请联系开发者或提交Issue。

希望本说明能帮助您顺利使用自动阅卷系统。祝您使用愉快！